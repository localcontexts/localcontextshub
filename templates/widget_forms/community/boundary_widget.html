<style>
    .related-widget-wrapper{
        width: 100%
    }
    .boundary-container{
        display: flex;
        margin-bottom: 10px;
    }
    .boundary-textarea{
        width: 90%
    }
    .delete-boundary{
        margin-left: 20px;
        background: lightgrey;
        color: white;
        font-weight: bold;
        cursor: pointer;
        width: 140px;
    }
    .delete-boundary:hover{
        background: darkgrey;
    }
    .delete-boundary.selected, .delete-boundary.selected:hover{
        background: #a41515;
    }
    #add-new-boundary{
        padding: 10px;
        cursor: pointer;
        background: #9be1a9;
        border-radius: 5px;
    }
    #add-new-boundary:hover{
        background: #86c993;
    }
    #upload-shape-file-data{
        padding: 10px;
        cursor: pointer;
        background: lightblue;
        border-radius: 5px;
        margin-left: 20px;
    }
    #upload-shape-file-data:hover {
        background: #8ebccb;
    }
</style>
<div id="boundaries-container">
    {% for boundary_id, boundary in boundaries.items %}
        <div class="boundary-container">
            <label for="boundary{{boundary_id}}">Boundary Id {{ boundary_id }}</label>
            <textarea
                    class="boundary-textarea" name="boundary{{boundary_id}}" rows="4"
                    cols="50">{{ boundary |join:", " }}</textarea>
            <button class="delete-boundary" data-for="{{boundary_id}}" onclick="markAsDeleted(); event.preventDefault()">
                Mark For Deletion
            </button>
        </div>
    {% endfor %}
</div>
<div id="deleted-boundaries" style="display:none"></div>
<button id="add-new-boundary" onclick="addNewBoundary(); event.preventDefault()">Add New Boundary</button>
<button id="upload-shape-file-data" onclick="event.preventDefault()">Upload Shape File Data</button>
<script>
function markAsDeleted() {
  const id = event.target.dataset.for
  const selectorKey = `boundary${id}`
  const deletedBoundaryMarker = document.querySelector(`[data-deleted=${selectorKey}]`)

  // -----------toggle deletion marker
  event.target.classList.toggle("selected");

  if (deletedBoundaryMarker) {
    // if marked for deletion, then remove marker
    deletedBoundaryMarker.remove()
  } else {
    // otherwise, add marker for deletion
    const deletedBoundariesContainer = document.getElementById('deleted-boundaries')
    deletedBoundariesContainer.insertAdjacentHTML(
      'beforeend',
      `<input type="text" data-deleted="${selectorKey}">`
    )
  }
  // -----------toggle deletion marker

}

function removeBoundary(){
  event.target.closest(".boundary-container").remove()
}
function addNewBoundary() {
    const boundaryContainer = document.getElementById('boundaries-container')
    boundaryContainer.insertAdjacentHTML(
      'beforeend',
      `<div class="boundary-container">
            <label>New Boundary</label>
            <textarea
                    class="boundary-textarea" rows="4"
                    cols="50"></textarea>
            <button class="delete-boundary" onclick="removeBoundary();event.preventDefault()">
                Remove
            </button>
        </div>`
    )
}
</script>
